# Interpreters: safe version checks and tool invocations

allowlists:
  commands:
    # ── Interpreters: version checks and read-only tools ───────────
    - { command: "python --version", trust: minimal }
    - { command: "python -V", trust: minimal }
    - { command: "python3 --version", trust: minimal }
    - { command: "python3 -V", trust: minimal }
    - { command: "python -m json.tool", trust: minimal }
    - { command: "python3 -m json.tool", trust: minimal }
    - { command: "python -m py_compile", trust: minimal }
    - { command: "python3 -m py_compile", trust: minimal }
    - { command: "python -m compileall", trust: minimal }
    - { command: "python3 -m compileall", trust: minimal }
    - { command: "node --version", trust: minimal }
    - { command: "node -v", trust: minimal }
    - { command: "ruby --version", trust: minimal }
    - { command: "ruby -v", trust: minimal }
    - { command: "python -m pytest", trust: minimal }
    - { command: "python3 -m pytest", trust: minimal }
    # ── uv: read-only invocations ──────────────────────────────────
    - { command: "uv pip list", trust: minimal }
    - { command: "uv pip show", trust: minimal }
    - { command: "uv pip freeze", trust: minimal }
    - { command: "uv pip check", trust: minimal }
    - { command: "uv --version", trust: minimal }
    - { command: "uv --help", trust: minimal }
    - { command: "uv -V", trust: minimal }
    # ── Cargo: read-only invocations ─────────────────────────────────
    - { command: "cargo tree", trust: minimal }
    - { command: "cargo metadata", trust: minimal }
    - { command: "cargo deny", trust: minimal }
    - { command: "cargo audit", trust: minimal }
    - { command: "cargo outdated", trust: minimal }
    # ── npm: read-only invocations ───────────────────────────────────
    - { command: "npm ls", trust: minimal }
    - { command: "npm outdated", trust: minimal }
    - { command: "npm audit", trust: minimal }
    - { command: "npm info", trust: minimal }
    # ── just: read-only invocations ──────────────────────────────────
    - { command: "just --list", trust: minimal }
    - { command: "just -l", trust: minimal }
    - { command: "just --version", trust: minimal }
    - { command: "just --help", trust: minimal }
    - { command: "just -h", trust: minimal }
    # ── uv: build/test/run tools ───────────────────────────────────
    - { command: "uv run pytest", trust: standard }
    - { command: "uv run mypy", trust: standard }
    - { command: "uv run ruff", trust: standard }
    - { command: "uv run black", trust: standard }
    - { command: "uv run isort", trust: standard }
    - { command: "uv run flake8", trust: standard }
    - { command: "uv run pylint", trust: standard }
    - { command: "uv run pyright", trust: standard }
    - { command: "uv run bandit", trust: standard }
    - { command: "uv run coverage", trust: standard }
    - { command: "uv run pre-commit", trust: standard }
    - { command: "uv sync", trust: standard }
    - { command: "uv lock", trust: standard }
    - { command: "uv venv", trust: standard }
    - { command: "uv pip", trust: standard }
    # ── Cargo: build/test/run tools ──────────────────────────────────
    - { command: "cargo build", trust: standard }
    - { command: "cargo test", trust: standard }
    - { command: "cargo check", trust: standard }
    - { command: "cargo clippy", trust: standard }
    - { command: "cargo fmt", trust: standard }
    - { command: "cargo run", trust: standard }
    - { command: "cargo bench", trust: standard }
    - { command: "cargo doc", trust: standard }
    - { command: "cargo clean", trust: standard }
    - { command: "cargo update", trust: standard }
    - { command: "cargo remove", trust: standard }
    - { command: "cargo init", trust: standard }
    - { command: "cargo new", trust: standard }
    - { command: "cargo vendor", trust: standard }
    - { command: "cargo release", trust: standard }
    - { command: "cargo expand", trust: standard }
    # ── npm: build/test/run tools ────────────────────────────────────
    # npm install/ci/exec - covered by rules (ask for confirmation)
    - { command: "npm test", trust: standard }
    - { command: "npm run", trust: standard }
    - { command: "npm start", trust: standard }
    - { command: "npm init", trust: standard }
    - { command: "npm pack", trust: standard }
    # ── npx: local dev tool invocations ────────────────────────────────
    # npx runs tools from local node_modules or downloads them.
    # Only known-safe dev tools are listed here; unknown packages
    # still get ask via default_decision.
    # -- Test runners --
    - { command: "npx vitest", trust: standard }
    - { command: "npx jest", trust: standard }
    - { command: "npx mocha", trust: standard }
    - { command: "npx playwright", trust: standard }
    - { command: "npx cypress", trust: standard }
    - { command: "npx ava", trust: standard }
    # -- Linters --
    - { command: "npx eslint", trust: standard }
    - { command: "npx biome", trust: standard }
    - { command: "npx stylelint", trust: standard }
    - { command: "npx markdownlint", trust: standard }
    - { command: "npx oxlint", trust: standard }
    # -- Formatters --
    - { command: "npx prettier", trust: standard }
    # -- Type checkers --
    - { command: "npx tsc", trust: standard }
    - { command: "npx vue-tsc", trust: standard }
    - { command: "npx svelte-check", trust: standard }
    # -- Build/dev tools --
    - { command: "npx vite", trust: standard }
    - { command: "npx webpack", trust: standard }
    - { command: "npx rollup", trust: standard }
    - { command: "npx esbuild", trust: standard }
    - { command: "npx turbo", trust: standard }
    - { command: "npx nx", trust: standard }
    - { command: "npx next", trust: standard }
    - { command: "npx nuxt", trust: standard }
    - { command: "npx astro", trust: standard }
    - { command: "npx svelte-kit", trust: standard }
    # -- Coverage --
    - { command: "npx c8", trust: standard }
    - { command: "npx nyc", trust: standard }
    # -- Dev utilities --
    - { command: "npx storybook", trust: standard }
    - { command: "npx tailwindcss", trust: standard }
    - { command: "npx postcss", trust: standard }
    - { command: "npx lint-staged", trust: standard }
    - { command: "npx nodemon", trust: standard }
    - { command: "npx tsx", trust: standard }
    - { command: "npx ts-node", trust: standard }
    - { command: "npx concurrently", trust: standard }
    # ── pnpm: direct tool invocations ──────────────────────────────────
    # pnpm <tool> runs from local node_modules, same as pnpm exec <tool>.
    # -- Test runners --
    - { command: "pnpm vitest", trust: standard }
    - { command: "pnpm jest", trust: standard }
    - { command: "pnpm mocha", trust: standard }
    - { command: "pnpm playwright", trust: standard }
    - { command: "pnpm cypress", trust: standard }
    - { command: "pnpm ava", trust: standard }
    # -- Linters --
    - { command: "pnpm eslint", trust: standard }
    - { command: "pnpm biome", trust: standard }
    - { command: "pnpm stylelint", trust: standard }
    - { command: "pnpm markdownlint", trust: standard }
    - { command: "pnpm oxlint", trust: standard }
    # -- Formatters --
    - { command: "pnpm prettier", trust: standard }
    # -- Type checkers --
    - { command: "pnpm tsc", trust: standard }
    - { command: "pnpm vue-tsc", trust: standard }
    - { command: "pnpm svelte-check", trust: standard }
    # -- Build/dev tools --
    - { command: "pnpm vite", trust: standard }
    - { command: "pnpm webpack", trust: standard }
    - { command: "pnpm rollup", trust: standard }
    - { command: "pnpm esbuild", trust: standard }
    - { command: "pnpm turbo", trust: standard }
    - { command: "pnpm nx", trust: standard }
    - { command: "pnpm next", trust: standard }
    - { command: "pnpm nuxt", trust: standard }
    - { command: "pnpm astro", trust: standard }
    - { command: "pnpm svelte-kit", trust: standard }
    # -- Coverage --
    - { command: "pnpm c8", trust: standard }
    - { command: "pnpm nyc", trust: standard }
    # -- Dev utilities --
    - { command: "pnpm storybook", trust: standard }
    - { command: "pnpm tailwindcss", trust: standard }
    - { command: "pnpm postcss", trust: standard }
    - { command: "pnpm lint-staged", trust: standard }
    - { command: "pnpm nodemon", trust: standard }
    - { command: "pnpm tsx", trust: standard }
    - { command: "pnpm ts-node", trust: standard }
    - { command: "pnpm concurrently", trust: standard }
    # ── just: build/test/run tools ───────────────────────────────────
    - { command: "just test", trust: standard }
    - { command: "just build", trust: standard }
    - { command: "just check", trust: standard }
    - { command: "just fmt", trust: standard }
    - { command: "just lint", trust: standard }
    - { command: "just release", trust: standard }

rules: []
