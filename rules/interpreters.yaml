# Interpreters: safe version checks and tool invocations

allowlists:
  commands:
    # ── Interpreters: version checks and read-only tools ───────────
    - { command: "python --version", trust: minimal }
    - { command: "python -V", trust: minimal }
    - { command: "python3 --version", trust: minimal }
    - { command: "python3 -V", trust: minimal }
    - { command: "python -m json.tool", trust: minimal }
    - { command: "python3 -m json.tool", trust: minimal }
    - { command: "python -m py_compile", trust: minimal }
    - { command: "python3 -m py_compile", trust: minimal }
    - { command: "python -m compileall", trust: minimal }
    - { command: "python3 -m compileall", trust: minimal }
    - { command: "node --version", trust: minimal }
    - { command: "node -v", trust: minimal }
    - { command: "ruby --version", trust: minimal }
    - { command: "ruby -v", trust: minimal }
    - { command: "python -m pytest", trust: minimal }
    - { command: "python3 -m pytest", trust: minimal }
    # ── uv: read-only invocations ──────────────────────────────────
    - { command: "uv pip list", trust: minimal }
    - { command: "uv pip show", trust: minimal }
    - { command: "uv pip freeze", trust: minimal }
    - { command: "uv pip check", trust: minimal }
    - { command: "uv --version", trust: minimal }
    - { command: "uv --help", trust: minimal }
    - { command: "uv -V", trust: minimal }
    # ── Cargo: read-only invocations ─────────────────────────────────
    - { command: "cargo tree", trust: minimal }
    - { command: "cargo metadata", trust: minimal }
    - { command: "cargo deny", trust: minimal }
    - { command: "cargo audit", trust: minimal }
    - { command: "cargo outdated", trust: minimal }
    # ── npm: read-only invocations ───────────────────────────────────
    - { command: "npm ls", trust: minimal }
    - { command: "npm outdated", trust: minimal }
    - { command: "npm audit", trust: minimal }
    - { command: "npm info", trust: minimal }
    # ── just: read-only invocations ──────────────────────────────────
    - { command: "just --list", trust: minimal }
    - { command: "just -l", trust: minimal }
    - { command: "just --version", trust: minimal }
    - { command: "just --help", trust: minimal }
    - { command: "just -h", trust: minimal }
    # ── uv: build/test/run tools ───────────────────────────────────
    - { command: "uv run pytest", trust: standard }
    - { command: "uv run mypy", trust: standard }
    - { command: "uv run ruff", trust: standard }
    - { command: "uv run black", trust: standard }
    - { command: "uv run isort", trust: standard }
    - { command: "uv run flake8", trust: standard }
    - { command: "uv run pylint", trust: standard }
    - { command: "uv run pyright", trust: standard }
    - { command: "uv run bandit", trust: standard }
    - { command: "uv run coverage", trust: standard }
    - { command: "uv run pre-commit", trust: standard }
    - { command: "uv sync", trust: standard }
    - { command: "uv lock", trust: standard }
    - { command: "uv venv", trust: standard }
    - { command: "uv pip", trust: standard }
    # ── Cargo: build/test/run tools ──────────────────────────────────
    - { command: "cargo build", trust: standard }
    - { command: "cargo test", trust: standard }
    - { command: "cargo check", trust: standard }
    - { command: "cargo clippy", trust: standard }
    - { command: "cargo fmt", trust: standard }
    - { command: "cargo run", trust: standard }
    - { command: "cargo bench", trust: standard }
    - { command: "cargo doc", trust: standard }
    - { command: "cargo clean", trust: standard }
    - { command: "cargo update", trust: standard }
    - { command: "cargo remove", trust: standard }
    - { command: "cargo init", trust: standard }
    - { command: "cargo new", trust: standard }
    - { command: "cargo vendor", trust: standard }
    - { command: "cargo release", trust: standard }
    - { command: "cargo expand", trust: standard }
    # ── npm: build/test/run tools ────────────────────────────────────
    # npm install/ci/exec - covered by rules (ask for confirmation)
    - { command: "npm test", trust: standard }
    - { command: "npm run", trust: standard }
    - { command: "npm start", trust: standard }
    - { command: "npm init", trust: standard }
    - { command: "npm pack", trust: standard }
    # ── npx: local dev tool invocations ────────────────────────────────
    # npx runs tools from local node_modules or downloads them.
    # Only known-safe dev tools are listed here; unknown packages
    # still get ask via default_decision.
    # -- Test runners --
    - { command: "npx vitest", trust: standard }
    - { command: "npx jest", trust: standard }
    - { command: "npx mocha", trust: standard }
    - { command: "npx playwright", trust: standard }
    - { command: "npx cypress", trust: standard }
    - { command: "npx ava", trust: standard }
    # -- Linters --
    - { command: "npx eslint", trust: standard }
    - { command: "npx biome", trust: standard }
    - { command: "npx stylelint", trust: standard }
    - { command: "npx markdownlint", trust: standard }
    - { command: "npx oxlint", trust: standard }
    # -- Formatters --
    - { command: "npx prettier", trust: standard }
    # -- Type checkers --
    - { command: "npx tsc", trust: standard }
    - { command: "npx vue-tsc", trust: standard }
    - { command: "npx svelte-check", trust: standard }
    # -- Build/dev tools --
    - { command: "npx vite", trust: standard }
    - { command: "npx webpack", trust: standard }
    - { command: "npx rollup", trust: standard }
    - { command: "npx esbuild", trust: standard }
    - { command: "npx turbo", trust: standard }
    - { command: "npx nx", trust: standard }
    - { command: "npx next", trust: standard }
    - { command: "npx nuxt", trust: standard }
    - { command: "npx astro", trust: standard }
    - { command: "npx svelte-kit", trust: standard }
    # -- Dev utilities --
    - { command: "npx storybook", trust: standard }
    - { command: "npx tailwindcss", trust: standard }
    - { command: "npx postcss", trust: standard }
    - { command: "npx lint-staged", trust: standard }
    - { command: "npx tsx", trust: standard }
    - { command: "npx ts-node", trust: standard }
    # ── pnpm: direct tool invocations ──────────────────────────────────
    # pnpm <tool> runs from local node_modules, same as pnpm exec <tool>.
    # -- Test runners --
    - { command: "pnpm vitest", trust: standard }
    - { command: "pnpm jest", trust: standard }
    - { command: "pnpm mocha", trust: standard }
    - { command: "pnpm playwright", trust: standard }
    - { command: "pnpm cypress", trust: standard }
    - { command: "pnpm ava", trust: standard }
    # -- Linters --
    - { command: "pnpm eslint", trust: standard }
    - { command: "pnpm biome", trust: standard }
    - { command: "pnpm stylelint", trust: standard }
    - { command: "pnpm markdownlint", trust: standard }
    - { command: "pnpm oxlint", trust: standard }
    # -- Formatters --
    - { command: "pnpm prettier", trust: standard }
    # -- Type checkers --
    - { command: "pnpm tsc", trust: standard }
    - { command: "pnpm vue-tsc", trust: standard }
    - { command: "pnpm svelte-check", trust: standard }
    # -- Build/dev tools --
    - { command: "pnpm vite", trust: standard }
    - { command: "pnpm webpack", trust: standard }
    - { command: "pnpm rollup", trust: standard }
    - { command: "pnpm esbuild", trust: standard }
    - { command: "pnpm turbo", trust: standard }
    - { command: "pnpm nx", trust: standard }
    - { command: "pnpm next", trust: standard }
    - { command: "pnpm nuxt", trust: standard }
    - { command: "pnpm astro", trust: standard }
    - { command: "pnpm svelte-kit", trust: standard }
    # -- Dev utilities --
    - { command: "pnpm storybook", trust: standard }
    - { command: "pnpm tailwindcss", trust: standard }
    - { command: "pnpm postcss", trust: standard }
    - { command: "pnpm lint-staged", trust: standard }
    - { command: "pnpm tsx", trust: standard }
    - { command: "pnpm ts-node", trust: standard }
    # ── pnpm exec: specific safe dev tools ────────────────────────────
    # pnpm exec is NOT blanket-allowed (can run arbitrary system commands).
    # Only known-safe dev tools listed; unknown commands get ask via default.
    # -- Test runners --
    - { command: "pnpm exec vitest", trust: standard }
    - { command: "pnpm exec jest", trust: standard }
    - { command: "pnpm exec mocha", trust: standard }
    - { command: "pnpm exec playwright", trust: standard }
    - { command: "pnpm exec cypress", trust: standard }
    - { command: "pnpm exec ava", trust: standard }
    # -- Linters --
    - { command: "pnpm exec eslint", trust: standard }
    - { command: "pnpm exec biome", trust: standard }
    - { command: "pnpm exec stylelint", trust: standard }
    - { command: "pnpm exec markdownlint", trust: standard }
    - { command: "pnpm exec oxlint", trust: standard }
    # -- Formatters --
    - { command: "pnpm exec prettier", trust: standard }
    # -- Type checkers --
    - { command: "pnpm exec tsc", trust: standard }
    - { command: "pnpm exec vue-tsc", trust: standard }
    - { command: "pnpm exec svelte-check", trust: standard }
    # -- Build/dev tools --
    - { command: "pnpm exec vite", trust: standard }
    - { command: "pnpm exec webpack", trust: standard }
    - { command: "pnpm exec rollup", trust: standard }
    - { command: "pnpm exec esbuild", trust: standard }
    - { command: "pnpm exec turbo", trust: standard }
    - { command: "pnpm exec nx", trust: standard }
    - { command: "pnpm exec next", trust: standard }
    - { command: "pnpm exec nuxt", trust: standard }
    - { command: "pnpm exec astro", trust: standard }
    - { command: "pnpm exec svelte-kit", trust: standard }
    # -- Dev utilities --
    - { command: "pnpm exec storybook", trust: standard }
    - { command: "pnpm exec tailwindcss", trust: standard }
    - { command: "pnpm exec postcss", trust: standard }
    - { command: "pnpm exec lint-staged", trust: standard }
    - { command: "pnpm exec tsx", trust: standard }
    - { command: "pnpm exec ts-node", trust: standard }
    # ── bunx: local dev tool invocations ───────────────────────────────
    # bunx is bun's equivalent of npx. Same tool list.
    # -- Test runners --
    - { command: "bunx vitest", trust: standard }
    - { command: "bunx jest", trust: standard }
    - { command: "bunx mocha", trust: standard }
    - { command: "bunx playwright", trust: standard }
    - { command: "bunx cypress", trust: standard }
    - { command: "bunx ava", trust: standard }
    # -- Linters --
    - { command: "bunx eslint", trust: standard }
    - { command: "bunx biome", trust: standard }
    - { command: "bunx stylelint", trust: standard }
    - { command: "bunx markdownlint", trust: standard }
    - { command: "bunx oxlint", trust: standard }
    # -- Formatters --
    - { command: "bunx prettier", trust: standard }
    # -- Type checkers --
    - { command: "bunx tsc", trust: standard }
    - { command: "bunx vue-tsc", trust: standard }
    - { command: "bunx svelte-check", trust: standard }
    # -- Build/dev tools --
    - { command: "bunx vite", trust: standard }
    - { command: "bunx webpack", trust: standard }
    - { command: "bunx rollup", trust: standard }
    - { command: "bunx esbuild", trust: standard }
    - { command: "bunx turbo", trust: standard }
    - { command: "bunx nx", trust: standard }
    - { command: "bunx next", trust: standard }
    - { command: "bunx nuxt", trust: standard }
    - { command: "bunx astro", trust: standard }
    - { command: "bunx svelte-kit", trust: standard }
    # -- Dev utilities --
    - { command: "bunx storybook", trust: standard }
    - { command: "bunx tailwindcss", trust: standard }
    - { command: "bunx postcss", trust: standard }
    - { command: "bunx lint-staged", trust: standard }
    - { command: "bunx tsx", trust: standard }
    - { command: "bunx ts-node", trust: standard }
    # ── yarn dlx: dev tool invocations ─────────────────────────────────
    # yarn dlx is yarn's equivalent of npx. Same tool list.
    # -- Test runners --
    - { command: "yarn dlx vitest", trust: standard }
    - { command: "yarn dlx jest", trust: standard }
    - { command: "yarn dlx mocha", trust: standard }
    - { command: "yarn dlx playwright", trust: standard }
    - { command: "yarn dlx cypress", trust: standard }
    - { command: "yarn dlx ava", trust: standard }
    # -- Linters --
    - { command: "yarn dlx eslint", trust: standard }
    - { command: "yarn dlx biome", trust: standard }
    - { command: "yarn dlx stylelint", trust: standard }
    - { command: "yarn dlx markdownlint", trust: standard }
    - { command: "yarn dlx oxlint", trust: standard }
    # -- Formatters --
    - { command: "yarn dlx prettier", trust: standard }
    # -- Type checkers --
    - { command: "yarn dlx tsc", trust: standard }
    - { command: "yarn dlx vue-tsc", trust: standard }
    - { command: "yarn dlx svelte-check", trust: standard }
    # -- Build/dev tools --
    - { command: "yarn dlx vite", trust: standard }
    - { command: "yarn dlx webpack", trust: standard }
    - { command: "yarn dlx rollup", trust: standard }
    - { command: "yarn dlx esbuild", trust: standard }
    - { command: "yarn dlx turbo", trust: standard }
    - { command: "yarn dlx nx", trust: standard }
    - { command: "yarn dlx next", trust: standard }
    - { command: "yarn dlx nuxt", trust: standard }
    - { command: "yarn dlx astro", trust: standard }
    - { command: "yarn dlx svelte-kit", trust: standard }
    # -- Dev utilities --
    - { command: "yarn dlx storybook", trust: standard }
    - { command: "yarn dlx tailwindcss", trust: standard }
    - { command: "yarn dlx postcss", trust: standard }
    - { command: "yarn dlx lint-staged", trust: standard }
    - { command: "yarn dlx tsx", trust: standard }
    - { command: "yarn dlx ts-node", trust: standard }
    # ── yarn exec: specific safe dev tools ────────────────────────────
    # yarn exec is NOT blanket-allowed (can run arbitrary shell commands).
    # Only known-safe dev tools listed; unknown commands get ask via default.
    # -- Test runners --
    - { command: "yarn exec vitest", trust: standard }
    - { command: "yarn exec jest", trust: standard }
    - { command: "yarn exec mocha", trust: standard }
    - { command: "yarn exec playwright", trust: standard }
    - { command: "yarn exec cypress", trust: standard }
    - { command: "yarn exec ava", trust: standard }
    # -- Linters --
    - { command: "yarn exec eslint", trust: standard }
    - { command: "yarn exec biome", trust: standard }
    - { command: "yarn exec stylelint", trust: standard }
    - { command: "yarn exec markdownlint", trust: standard }
    - { command: "yarn exec oxlint", trust: standard }
    # -- Formatters --
    - { command: "yarn exec prettier", trust: standard }
    # -- Type checkers --
    - { command: "yarn exec tsc", trust: standard }
    - { command: "yarn exec vue-tsc", trust: standard }
    - { command: "yarn exec svelte-check", trust: standard }
    # -- Build/dev tools --
    - { command: "yarn exec vite", trust: standard }
    - { command: "yarn exec webpack", trust: standard }
    - { command: "yarn exec rollup", trust: standard }
    - { command: "yarn exec esbuild", trust: standard }
    - { command: "yarn exec turbo", trust: standard }
    - { command: "yarn exec nx", trust: standard }
    - { command: "yarn exec next", trust: standard }
    - { command: "yarn exec nuxt", trust: standard }
    - { command: "yarn exec astro", trust: standard }
    - { command: "yarn exec svelte-kit", trust: standard }
    # -- Dev utilities --
    - { command: "yarn exec storybook", trust: standard }
    - { command: "yarn exec tailwindcss", trust: standard }
    - { command: "yarn exec postcss", trust: standard }
    - { command: "yarn exec lint-staged", trust: standard }
    - { command: "yarn exec tsx", trust: standard }
    - { command: "yarn exec ts-node", trust: standard }
    # ── just: build/test/run tools ───────────────────────────────────
    - { command: "just test", trust: standard }
    - { command: "just build", trust: standard }
    - { command: "just check", trust: standard }
    - { command: "just fmt", trust: standard }
    - { command: "just lint", trust: standard }
    - { command: "just release", trust: standard }

rules: []
