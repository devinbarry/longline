tests:
  - id: ls-safe
    command: "ls -la /tmp"
    expected:
      decision: allow
  - id: echo-safe
    command: "echo hello world"
    expected:
      decision: allow
  - id: pwd-safe
    command: "pwd"
    expected:
      decision: allow
  - id: whoami-safe
    command: "whoami"
    expected:
      decision: allow
  - id: cat-readme-safe
    command: "cat README.md"
    expected:
      decision: allow
  - id: grep-safe
    command: "grep -r 'function' src/"
    expected:
      decision: allow
  - id: cargo-build-safe
    command: "cargo build"
    expected:
      decision: allow
  - id: cargo-test-safe
    command: "cargo test"
    expected:
      decision: allow
  - id: npm-install-safe
    command: "npm install"
    expected:
      decision: allow
  - id: npm-test-safe
    command: "npm test"
    expected:
      decision: allow
  - id: python-script-ask
    command: "python3 script.py"
    expected:
      decision: ask
  - id: make-safe
    command: "make build"
    expected:
      decision: allow
  - id: mkdir-safe
    command: "mkdir -p /tmp/build"
    expected:
      decision: allow
  - id: touch-safe
    command: "touch newfile.txt"
    expected:
      decision: allow
  - id: cp-safe
    command: "cp src/main.rs src/main.rs.bak"
    expected:
      decision: allow
  - id: mv-safe
    command: "mv old.txt new.txt"
    expected:
      decision: allow
  - id: date-safe
    command: "date"
    expected:
      decision: allow
  - id: sort-safe
    command: "sort file.txt"
    expected:
      decision: allow
  - id: jq-safe
    command: "jq '.name' package.json"
    expected:
      decision: allow
  - id: tar-safe
    command: "tar -czf archive.tar.gz src/"
    expected:
      decision: allow
  - id: wc-safe
    command: "wc -l src/main.rs"
    expected:
      decision: allow
  - id: file-safe
    command: "file binary.out"
    expected:
      decision: allow
  - id: which-safe
    command: "which cargo"
    expected:
      decision: allow
  - id: type-safe
    command: "type ls"
    expected:
      decision: allow
  - id: basename-safe
    command: "basename /path/to/file.txt"
    expected:
      decision: allow
  - id: dirname-safe
    command: "dirname /path/to/file.txt"
    expected:
      decision: allow
  - id: realpath-safe
    command: "realpath ./src"
    expected:
      decision: allow
  - id: readlink-safe
    command: "readlink -f /usr/bin/python3"
    expected:
      decision: allow
  - id: head-safe
    command: "head -n 10 file.txt"
    expected:
      decision: allow
  - id: tail-safe
    command: "tail -f /var/log/syslog"
    expected:
      decision: allow
  - id: uniq-safe
    command: "uniq -c file.txt"
    expected:
      decision: allow
  - id: tr-safe
    command: "tr '[:lower:]' '[:upper:]'"
    expected:
      decision: allow
  - id: cut-safe
    command: "cut -d: -f1 /etc/passwd"
    expected:
      decision: allow
  - id: diff-safe
    command: "diff file1.txt file2.txt"
    expected:
      decision: allow
  - id: sed-safe
    command: "sed 's/old/new/g' file.txt"
    expected:
      decision: allow
  - id: awk-safe
    command: "awk '{print $1}' file.txt"
    expected:
      decision: allow
  - id: ln-safe
    command: "ln -s source target"
    expected:
      decision: allow
  - id: gzip-safe
    command: "gzip file.txt"
    expected:
      decision: allow
  - id: gunzip-safe
    command: "gunzip file.txt.gz"
    expected:
      decision: allow
  - id: zip-safe
    command: "zip archive.zip file.txt"
    expected:
      decision: allow
  - id: unzip-safe
    command: "unzip archive.zip"
    expected:
      decision: allow
  - id: rustc-safe
    command: "rustc --version"
    expected:
      decision: allow
  - id: npx-safe
    command: "npx create-react-app myapp"
    expected:
      decision: allow
  - id: node-inline-ask
    command: "node -e 'console.log(1)'"
    expected:
      decision: ask
  - id: pip-safe
    command: "pip install requests"
    expected:
      decision: allow
  - id: pip3-safe
    command: "pip3 install flask"
    expected:
      decision: allow
  - id: ruby-script-ask
    command: "ruby script.rb"
    expected:
      decision: ask
  - id: gem-safe
    command: "gem install bundler"
    expected:
      decision: allow
  - id: go-safe
    command: "go build ./..."
    expected:
      decision: allow
  - id: java-safe
    command: "java -jar app.jar"
    expected:
      decision: allow
  - id: javac-safe
    command: "javac Main.java"
    expected:
      decision: allow
  - id: cmake-safe
    command: "cmake .."
    expected:
      decision: allow
  - id: rg-safe
    command: "rg 'pattern' src/"
    expected:
      decision: allow
  - id: fd-safe
    command: "fd -e rs"
    expected:
      decision: allow
  - id: yq-safe
    command: "yq '.name' config.yaml"
    expected:
      decision: allow
  - id: patch-safe
    command: "patch -p1 < fix.patch"
    expected:
      decision: allow
  - id: test-safe
    command: "test -f file.txt"
    expected:
      decision: allow
  - id: true-safe
    command: "true"
    expected:
      decision: allow
  - id: false-safe
    command: "false"
    expected:
      decision: allow
  - id: python-version
    command: "python --version"
    expected:
      decision: allow
  - id: cat-plain-file
    command: "cat /etc/passwd"
    expected:
      decision: allow
  - id: echo-empty
    command: "echo"
    expected:
      decision: allow
  - id: ls-no-args
    command: "ls"
    expected:
      decision: allow
  - id: grep-count
    command: "grep -c 'TODO' src/main.rs"
    expected:
      decision: allow
  - id: cargo-clippy
    command: "cargo clippy"
    expected:
      decision: allow
  - id: npm-run-build
    command: "npm run build"
    expected:
      decision: allow
  - id: make-clean
    command: "make clean"
    expected:
      decision: allow
  - id: mv-rename
    command: "mv src/old.rs src/new.rs"
    expected:
      decision: allow
  - id: cp-recursive
    command: "cp -r src/ backup/"
    expected:
      decision: allow
  - id: mkdir-nested
    command: "mkdir -p a/b/c/d"
    expected:
      decision: allow
  - id: touch-multiple
    command: "touch a.txt b.txt c.txt"
    expected:
      decision: allow
  - id: sort-reverse
    command: "sort -r file.txt"
    expected:
      decision: allow
  - id: tar-extract
    command: "tar -xzf archive.tar.gz"
    expected:
      decision: allow
  - id: stat-safe
    command: "stat file.txt"
    expected:
      decision: allow
  - id: du-safe
    command: "du -sh src/"
    expected:
      decision: allow
  - id: printf-safe
    command: "printf '%s\\n' hello"
    expected:
      decision: allow
  - id: md5sum-safe
    command: "md5sum file.txt"
    expected:
      decision: allow
  - id: sha256sum-safe
    command: "sha256sum file.txt"
    expected:
      decision: allow
  - id: sha1sum-safe
    command: "sha1sum file.txt"
    expected:
      decision: allow
  - id: cksum-safe
    command: "cksum file.txt"
    expected:
      decision: allow
  # ── Cargo safe invocations ──────────────────────────────────────
  - id: cargo-check-safe
    command: "cargo check"
    expected:
      decision: allow
  - id: cargo-fmt-safe
    command: "cargo fmt"
    expected:
      decision: allow
  - id: cargo-run-safe
    command: "cargo run -- --arg"
    expected:
      decision: allow
  - id: cargo-doc-safe
    command: "cargo doc --open"
    expected:
      decision: allow
  - id: cargo-clean-safe
    command: "cargo clean"
    expected:
      decision: allow
  - id: cargo-add-safe
    command: "cargo add serde"
    expected:
      decision: allow
  - id: cargo-tree-safe
    command: "cargo tree"
    expected:
      decision: allow
  # ── npm safe invocations ────────────────────────────────────────
  - id: npm-ci-safe
    command: "npm ci"
    expected:
      decision: allow
  - id: npm-start-safe
    command: "npm start"
    expected:
      decision: allow
  - id: npm-audit-safe
    command: "npm audit"
    expected:
      decision: allow
  - id: npm-ls-safe
    command: "npm ls"
    expected:
      decision: allow
  # ── pip safe invocations ────────────────────────────────────────
  - id: pip-list-safe
    command: "pip list"
    expected:
      decision: allow
  - id: pip-freeze-safe
    command: "pip freeze"
    expected:
      decision: allow
  # ── go safe invocations ─────────────────────────────────────────
  - id: go-test-safe
    command: "go test ./..."
    expected:
      decision: allow
  - id: go-run-safe
    command: "go run main.go"
    expected:
      decision: allow
  - id: go-vet-safe
    command: "go vet ./..."
    expected:
      decision: allow
  - id: go-fmt-safe
    command: "go fmt ./..."
    expected:
      decision: allow
  - id: go-mod-safe
    command: "go mod tidy"
    expected:
      decision: allow
  - id: go-env-safe
    command: "go env"
    expected:
      decision: allow
  - id: go-version-safe
    command: "go version"
    expected:
      decision: allow
  # ── gem safe invocations ────────────────────────────────────────
  - id: gem-list-safe
    command: "gem list"
    expected:
      decision: allow
