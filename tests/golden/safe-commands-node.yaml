tests:
  # ── npm safe invocations ────────────────────────────────────────
  - id: npm-install-safe
    command: "npm install"
    expected:
      decision: ask
      rule_id: npm-install
  - id: npm-test-safe
    command: "npm test"
    expected:
      decision: allow
  - id: npm-run-build
    command: "npm run build"
    expected:
      decision: allow
  - id: npm-ci-safe
    command: "npm ci"
    expected:
      decision: ask
      rule_id: npm-install
  - id: npm-start-safe
    command: "npm start"
    expected:
      decision: allow
  - id: npm-audit-safe
    command: "npm audit"
    expected:
      decision: allow
  - id: npm-ls-safe
    command: "npm ls"
    expected:
      decision: allow
  - id: npx-safe
    command: "npx create-react-app myapp"
    expected:
      decision: ask
  - id: node-inline-ask
    command: "node -e 'console.log(1)'"
    expected:
      decision: ask

  # ── Node package manager version checks ──────────────────────────
  - id: yarn-version-safe
    command: "yarn --version"
    expected:
      decision: allow
  - id: pnpm-version-safe
    command: "pnpm --version"
    expected:
      decision: allow
  - id: bun-version-safe
    command: "bun --version"
    expected:
      decision: allow
  - id: deno-version-safe
    command: "deno --version"
    expected:
      decision: allow

  # ── Node package manager read-only commands ──────────────────────
  - id: yarn-list-safe
    command: "yarn list"
    expected:
      decision: allow
  - id: pnpm-list-safe
    command: "pnpm list"
    expected:
      decision: allow
  - id: deno-info-safe
    command: "deno info"
    expected:
      decision: allow
