tests:
  - id: cat-env-file-allowlisted
    command: "cat .env"
    expected:
      decision: allow
  - id: less-env-file
    command: "less .env"
    expected:
      decision: deny
      rule_id: cat-env-file
  - id: less-env-local
    command: "less .env.local"
    expected:
      decision: deny
      rule_id: cat-env-file
  - id: less-env-production
    command: "less .env.production"
    expected:
      decision: deny
      rule_id: cat-env-file
  - id: bat-env-file
    command: "bat .env"
    expected:
      decision: deny
      rule_id: cat-env-file
  - id: more-ssh-key
    command: "more ~/.ssh/id_rsa"
    expected:
      decision: deny
      rule_id: cat-ssh-key
  - id: bat-ssh-ed25519
    command: "bat ~/.ssh/id_ed25519"
    expected:
      decision: deny
      rule_id: cat-ssh-key
  - id: less-aws-creds
    command: "less ~/.aws/credentials"
    expected:
      decision: deny
      rule_id: cat-aws-creds
  - id: more-kube-config
    command: "more ~/.kube/config"
    expected:
      decision: deny
      rule_id: cat-kube-config
  - id: printenv-secrets
    command: "printenv"
    expected:
      decision: ask
      rule_id: printenv
  - id: env-dump
    command: "env"
    expected:
      decision: ask
      rule_id: printenv
