tests:
  # ════════════════════════════════════════════════════════════════
  # sleep: always safe (just waits)
  # ════════════════════════════════════════════════════════════════
  - id: sleep-safe
    command: "sleep 5"
    expected:
      decision: allow
  - id: sleep-long-safe
    command: "sleep 60"
    expected:
      decision: allow
  - id: sleep-fractional-safe
    command: "sleep 0.5"
    expected:
      decision: allow

  # ════════════════════════════════════════════════════════════════
  # just: only read-only invocations allowed
  # ════════════════════════════════════════════════════════════════
  # Positive tests (should allow)
  - id: just-list-safe
    command: "just --list"
    expected:
      decision: allow
  - id: just-list-short-safe
    command: "just -l"
    expected:
      decision: allow
  - id: just-version-safe
    command: "just --version"
    expected:
      decision: allow
  - id: just-help-safe
    command: "just --help"
    expected:
      decision: allow
  - id: just-help-short-safe
    command: "just -h"
    expected:
      decision: allow

  # Standard dev recipes (should allow)
  - id: just-build-safe
    command: "just build"
    expected:
      decision: allow
  - id: just-test-safe
    command: "just test"
    expected:
      decision: allow
  - id: just-check-safe
    command: "just check"
    expected:
      decision: allow
  - id: just-fmt-safe
    command: "just fmt"
    expected:
      decision: allow
  - id: just-lint-safe
    command: "just lint"
    expected:
      decision: allow

  # Negative tests (should ask - runs arbitrary recipes or bare command)
  - id: just-bare-ask
    command: "just"
    expected:
      decision: ask
  - id: just-recipe-release-ask
    command: "just release patch"
    expected:
      decision: ask
  - id: just-recipe-clean-ask
    command: "just clean"
    expected:
      decision: ask
  - id: just-unknown-recipe-ask
    command: "just foobar"
    expected:
      decision: ask

  # ════════════════════════════════════════════════════════════════
  # glp (GitLab Pipeline CLI): read-only invocations allowed
  # ════════════════════════════════════════════════════════════════
  # Positive tests (should allow)
  - id: glp-status-safe
    command: "glp status"
    expected:
      decision: allow
  - id: glp-status-json-safe
    command: "glp status --json"
    expected:
      decision: allow
  - id: glp-jobs-safe
    command: "glp jobs"
    expected:
      decision: allow
  - id: glp-jobs-id-safe
    command: "glp jobs 742"
    expected:
      decision: allow
  - id: glp-log-safe
    command: "glp log 123"
    expected:
      decision: allow
  - id: glp-log-tail-safe
    command: "glp log 2661 --tail 50"
    expected:
      decision: allow
  - id: glp-version-safe
    command: "glp --version"
    expected:
      decision: allow
  - id: glp-help-safe
    command: "glp --help"
    expected:
      decision: allow
  - id: glp-help-short-safe
    command: "glp -h"
    expected:
      decision: allow

  # Negative tests (should ask - not allowlisted)
  - id: glp-bare-ask
    command: "glp"
    expected:
      decision: ask
  - id: glp-retry-ask
    command: "glp retry 123"
    expected:
      decision: ask
  - id: glp-cancel-ask
    command: "glp cancel 123"
    expected:
      decision: ask
  - id: glp-unknown-ask
    command: "glp unknown-command"
    expected:
      decision: ask
  - id: glp-blowup-ask
    command: "glp blowup server"
    expected:
      decision: ask

  # ════════════════════════════════════════════════════════════════
  # glab (GitLab CLI): read-only invocations allowed
  # ════════════════════════════════════════════════════════════════
  # Positive tests (should allow)
  - id: glab-auth-status-safe
    command: "glab auth status"
    expected:
      decision: allow
  - id: glab-ci-status-safe
    command: "glab ci status"
    expected:
      decision: allow
  - id: glab-ci-status-repo-safe
    command: "glab ci status --repo tools/longline"
    expected:
      decision: allow
  - id: glab-ci-view-safe
    command: "glab ci view"
    expected:
      decision: allow
  - id: glab-ci-list-safe
    command: "glab ci list"
    expected:
      decision: allow
  - id: glab-repo-list-safe
    command: "glab repo list"
    expected:
      decision: allow
  - id: glab-repo-view-safe
    command: "glab repo view"
    expected:
      decision: allow
  - id: glab-group-list-safe
    command: "glab group list"
    expected:
      decision: allow
  - id: glab-issue-list-safe
    command: "glab issue list"
    expected:
      decision: allow
  - id: glab-issue-view-safe
    command: "glab issue view 42"
    expected:
      decision: allow
  - id: glab-mr-list-safe
    command: "glab mr list"
    expected:
      decision: allow
  - id: glab-mr-view-safe
    command: "glab mr view 123"
    expected:
      decision: allow
  - id: glab-version-safe
    command: "glab --version"
    expected:
      decision: allow
  - id: glab-help-safe
    command: "glab --help"
    expected:
      decision: allow
  # glab ci trace and get (should allow)
  - id: glab-ci-trace-safe
    command: "glab ci trace"
    expected:
      decision: allow
  - id: glab-ci-trace-job-safe
    command: "glab ci trace build_job"
    expected:
      decision: allow
  - id: glab-ci-get-safe
    command: "glab ci get"
    expected:
      decision: allow
  # glab api read operations (should allow - GET is default)
  - id: glab-api-bare-safe
    command: "glab api"
    expected:
      decision: allow
  - id: glab-api-read-safe
    command: "glab api projects"
    expected:
      decision: allow
  - id: glab-api-pipelines-safe
    command: "glab api projects/tools%2Flongline/pipelines"
    expected:
      decision: allow
  - id: glab-api-jobs-safe
    command: "glab api projects/tools%2Flongline/pipelines/123/jobs"
    expected:
      decision: allow

  # Negative tests (should ask - not allowlisted or potentially destructive)
  - id: glab-bare-ask
    command: "glab"
    expected:
      decision: ask
  # glab api mutating operations (should ask - caught by rule)
  - id: glab-api-post-ask
    command: "glab api -X POST projects"
    expected:
      decision: ask
  - id: glab-api-method-post-ask
    command: "glab api projects/foo/pipeline --method POST"
    expected:
      decision: ask
  - id: glab-api-delete-ask
    command: "glab api projects/foo -X DELETE"
    expected:
      decision: ask
  - id: glab-api-put-ask
    command: "glab api projects/foo --method PUT"
    expected:
      decision: ask
  - id: glab-api-patch-ask
    command: "glab api projects/foo -X PATCH"
    expected:
      decision: ask
  - id: glab-repo-create-ask
    command: "glab repo create myrepo"
    expected:
      decision: ask
  - id: glab-repo-delete-ask
    command: "glab repo delete myrepo"
    expected:
      decision: ask
  - id: glab-repo-fork-ask
    command: "glab repo fork"
    expected:
      decision: ask
  - id: glab-mr-create-ask
    command: "glab mr create"
    expected:
      decision: ask
  - id: glab-mr-merge-ask
    command: "glab mr merge 123"
    expected:
      decision: ask
  - id: glab-issue-create-ask
    command: "glab issue create"
    expected:
      decision: ask
  - id: glab-ci-run-ask
    command: "glab ci run"
    expected:
      decision: ask
  - id: glab-ci-retry-ask
    command: "glab ci retry"
    expected:
      decision: ask
  - id: glab-auth-login-ask
    command: "glab auth login"
    expected:
      decision: ask
  - id: glab-config-set-ask
    command: "glab config set editor vim"
    expected:
      decision: ask
  - id: glab-blowup-server-ask
    command: "glab blowup server"
    expected:
      decision: ask
  - id: glab-unknown-ask
    command: "glab unknown-command"
    expected:
      decision: ask

  # ════════════════════════════════════════════════════════════════
  # git-cliff: stdout-only invocations allowed
  # ════════════════════════════════════════════════════════════════
  # Positive tests (should allow - output to stdout)
  - id: git-cliff-unreleased-safe
    command: "git-cliff --unreleased"
    expected:
      decision: allow
  - id: git-cliff-latest-safe
    command: "git-cliff --latest"
    expected:
      decision: allow
  - id: git-cliff-current-safe
    command: "git-cliff --current"
    expected:
      decision: allow

  # Negative tests (should ask - writes files or other operations)
  - id: git-cliff-bare-ask
    command: "git-cliff"
    expected:
      decision: ask
  - id: git-cliff-output-ask
    command: "git-cliff -o CHANGELOG.md"
    expected:
      decision: ask
  - id: git-cliff-output-long-ask
    command: "git-cliff --output CHANGELOG.md"
    expected:
      decision: ask
  - id: git-cliff-tag-ask
    command: "git-cliff --tag v1.0.0"
    expected:
      decision: ask
  - id: git-cliff-init-ask
    command: "git-cliff --init"
    expected:
      decision: ask

  # ════════════════════════════════════════════════════════════════
  # cargo install: should always ask (downloads/runs arbitrary code)
  # ════════════════════════════════════════════════════════════════
  - id: cargo-install-ask
    command: "cargo install ripgrep"
    expected:
      decision: ask
  - id: cargo-install-path-ask
    command: "cargo install --path ."
    expected:
      decision: ask
  - id: cargo-install-git-ask
    command: "cargo install --git https://github.com/user/repo"
    expected:
      decision: ask

  # ════════════════════════════════════════════════════════════════
  # chmod: should always ask (modifies permissions)
  # ════════════════════════════════════════════════════════════════
  - id: chmod-executable-ask
    command: "chmod +x script.sh"
    expected:
      decision: ask
  - id: chmod-755-ask
    command: "chmod 755 script.sh"
    expected:
      decision: ask
  - id: chmod-recursive-ask
    command: "chmod -R +x scripts/"
    expected:
      decision: ask

  # ════════════════════════════════════════════════════════════════
  # gh (GitHub CLI): read-only invocations allowed
  # ════════════════════════════════════════════════════════════════
  # Positive tests (should allow)
  - id: gh-pr-list-safe
    command: "gh pr list"
    expected:
      decision: allow
  - id: gh-pr-view-safe
    command: "gh pr view 123"
    expected:
      decision: allow
  - id: gh-pr-status-safe
    command: "gh pr status"
    expected:
      decision: allow
  - id: gh-pr-diff-safe
    command: "gh pr diff 123"
    expected:
      decision: allow
  - id: gh-pr-checks-safe
    command: "gh pr checks 123"
    expected:
      decision: allow
  - id: gh-issue-list-safe
    command: "gh issue list"
    expected:
      decision: allow
  - id: gh-issue-view-safe
    command: "gh issue view 42"
    expected:
      decision: allow
  - id: gh-issue-status-safe
    command: "gh issue status"
    expected:
      decision: allow
  - id: gh-repo-list-safe
    command: "gh repo list"
    expected:
      decision: allow
  - id: gh-repo-view-safe
    command: "gh repo view"
    expected:
      decision: allow
  - id: gh-auth-status-safe
    command: "gh auth status"
    expected:
      decision: allow
  - id: gh-version-safe
    command: "gh --version"
    expected:
      decision: allow
  - id: gh-help-safe
    command: "gh --help"
    expected:
      decision: allow
  - id: gh-help-short-safe
    command: "gh -h"
    expected:
      decision: allow
  # gh run and workflow commands (should allow)
  - id: gh-run-list-safe
    command: "gh run list"
    expected:
      decision: allow
  - id: gh-run-list-repo-safe
    command: "gh run list --repo owner/repo"
    expected:
      decision: allow
  - id: gh-run-view-safe
    command: "gh run view 123"
    expected:
      decision: allow
  - id: gh-run-view-log-safe
    command: "gh run view 123 --log"
    expected:
      decision: allow
  - id: gh-run-watch-safe
    command: "gh run watch 123"
    expected:
      decision: allow
  - id: gh-workflow-list-safe
    command: "gh workflow list"
    expected:
      decision: allow
  - id: gh-workflow-view-safe
    command: "gh workflow view CI"
    expected:
      decision: allow
  # gh api read operations (should allow - GET is default)
  - id: gh-api-bare-safe
    command: "gh api"
    expected:
      decision: allow
  - id: gh-api-read-safe
    command: "gh api repos/owner/repo"
    expected:
      decision: allow
  - id: gh-api-contents-safe
    command: "gh api repos/owner/repo/contents"
    expected:
      decision: allow
  - id: gh-api-jq-safe
    command: "gh api repos/owner/repo --jq '.name'"
    expected:
      decision: allow

  # Negative tests (should ask - not allowlisted or potentially destructive)
  - id: gh-bare-ask
    command: "gh"
    expected:
      decision: ask
  - id: gh-pr-create-ask
    command: "gh pr create"
    expected:
      decision: ask
  - id: gh-pr-merge-ask
    command: "gh pr merge 123"
    expected:
      decision: ask
  - id: gh-pr-close-ask
    command: "gh pr close 123"
    expected:
      decision: ask
  - id: gh-issue-create-ask
    command: "gh issue create"
    expected:
      decision: ask
  - id: gh-issue-close-ask
    command: "gh issue close 42"
    expected:
      decision: ask
  - id: gh-repo-create-ask
    command: "gh repo create myrepo"
    expected:
      decision: ask
  - id: gh-repo-delete-ask
    command: "gh repo delete myrepo"
    expected:
      decision: ask
  # gh api mutating operations (should ask - caught by rule)
  - id: gh-api-post-ask
    command: "gh api repos/owner/repo -X POST"
    expected:
      decision: ask
  - id: gh-api-method-post-ask
    command: "gh api repos/owner/repo --method POST"
    expected:
      decision: ask
  - id: gh-api-delete-ask
    command: "gh api repos/owner/repo -X DELETE"
    expected:
      decision: ask
  - id: gh-api-patch-ask
    command: "gh api repos/owner/repo --method PATCH"
    expected:
      decision: ask
  - id: gh-api-put-ask
    command: "gh api repos/owner/repo -X PUT"
    expected:
      decision: ask
  - id: gh-auth-login-ask
    command: "gh auth login"
    expected:
      decision: ask
  - id: gh-unknown-ask
    command: "gh unknown-command"
    expected:
      decision: ask

  # ════════════════════════════════════════════════════════════════
  # uv: additional safe operations
  # ════════════════════════════════════════════════════════════════
  # Positive tests (should allow)
  - id: uv-sync-safe
    command: "uv sync"
    expected:
      decision: allow
  - id: uv-sync-frozen-safe
    command: "uv sync --frozen"
    expected:
      decision: allow
  - id: uv-lock-safe
    command: "uv lock"
    expected:
      decision: allow
  - id: uv-lock-upgrade-safe
    command: "uv lock --upgrade"
    expected:
      decision: allow
  - id: uv-venv-safe
    command: "uv venv"
    expected:
      decision: allow
  - id: uv-venv-path-safe
    command: "uv venv .venv"
    expected:
      decision: allow
  - id: uv-pip-safe
    command: "uv pip"
    expected:
      decision: allow
  - id: uv-pip-list-safe
    command: "uv pip list"
    expected:
      decision: allow
  - id: uv-pip-install-safe
    command: "uv pip install requests"
    expected:
      decision: allow
  - id: uv-run-precommit-safe
    command: "uv run pre-commit"
    expected:
      decision: allow
  - id: uv-run-precommit-all-safe
    command: "uv run pre-commit run --all-files"
    expected:
      decision: allow
  - id: uv-run-precommit-install-safe
    command: "uv run pre-commit install"
    expected:
      decision: allow
  - id: uv-version-safe
    command: "uv --version"
    expected:
      decision: allow
  - id: uv-version-short-safe
    command: "uv -V"
    expected:
      decision: allow
  - id: uv-help-safe
    command: "uv --help"
    expected:
      decision: allow

  # ════════════════════════════════════════════════════════════════
  # cargo: additional safe subcommands
  # ════════════════════════════════════════════════════════════════
  # Positive tests (should allow)
  - id: cargo-release-safe
    command: "cargo release"
    expected:
      decision: allow
  - id: cargo-release-patch-safe
    command: "cargo release patch"
    expected:
      decision: allow
  - id: cargo-release-dry-run-safe
    command: "cargo release --dry-run"
    expected:
      decision: allow
  - id: cargo-deny-safe
    command: "cargo deny"
    expected:
      decision: allow
  - id: cargo-deny-check-safe
    command: "cargo deny check"
    expected:
      decision: allow
  - id: cargo-audit-safe
    command: "cargo audit"
    expected:
      decision: allow
  - id: cargo-outdated-safe
    command: "cargo outdated"
    expected:
      decision: allow
  - id: cargo-expand-safe
    command: "cargo expand"
    expected:
      decision: allow
  - id: cargo-expand-mod-safe
    command: "cargo expand parser"
    expected:
      decision: allow

  # ════════════════════════════════════════════════════════════════
  # python: pytest as module
  # ════════════════════════════════════════════════════════════════
  # Positive tests (should allow)
  - id: python-m-pytest-safe
    command: "python -m pytest"
    expected:
      decision: allow
  - id: python-m-pytest-verbose-safe
    command: "python -m pytest -v"
    expected:
      decision: allow
  - id: python-m-pytest-path-safe
    command: "python -m pytest tests/"
    expected:
      decision: allow
  - id: python3-m-pytest-safe
    command: "python3 -m pytest"
    expected:
      decision: allow
  - id: python3-m-pytest-verbose-safe
    command: "python3 -m pytest -v"
    expected:
      decision: allow
  - id: python3-m-pytest-path-safe
    command: "python3 -m pytest tests/unit/"
    expected:
      decision: allow
