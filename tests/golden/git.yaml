tests:
  - id: git-status-safe
    command: "git status"
    expected:
      decision: allow
  - id: git-diff-safe
    command: "git diff"
    expected:
      decision: allow
  - id: git-log-safe
    command: "git log"
    expected:
      decision: allow
  - id: git-branch-safe
    command: "git branch"
    expected:
      decision: allow
  - id: git-show-safe
    command: "git show"
    expected:
      decision: allow
  - id: git-force-push-main
    command: "git push --force origin main"
    expected:
      decision: deny
      rule_id: git-force-push-main
  - id: git-force-push-master
    command: "git push -f origin master"
    expected:
      decision: deny
      rule_id: git-force-push-main
  - id: git-reset-hard
    command: "git reset --hard HEAD~1"
    expected:
      decision: ask
      rule_id: git-reset-hard
  - id: git-clean-f
    command: "git clean -f"
    expected:
      decision: ask
      rule_id: git-clean-force
  - id: git-clean-fd
    command: "git clean -fd"
    expected:
      decision: ask
      rule_id: git-clean-force
  - id: git-branch-D-ask
    command: "git branch -D feature-branch"
    expected:
      decision: ask
      rule_id: git-branch-delete-force
  - id: git-add
    command: "git add ."
    expected:
      decision: allow
  - id: git-commit
    command: "git commit -m 'fix: some bug'"
    expected:
      decision: allow
  - id: git-commit-amend
    command: "git commit --amend"
    expected:
      decision: ask
      rule_id: git-commit-amend
  - id: git-commit-amend-message
    command: "git commit --amend -m 'updated message'"
    expected:
      decision: ask
      rule_id: git-commit-amend
  - id: git-push
    command: "git push origin feature-branch"
    expected:
      decision: allow
  - id: git-stash-list-safe
    command: "git stash list"
    expected:
      decision: allow
  - id: git-remote-safe
    command: "git remote -v"
    expected:
      decision: allow
  - id: git-tag-safe
    command: "git tag"
    expected:
      decision: allow
  - id: git-rev-parse-safe
    command: "git rev-parse HEAD"
    expected:
      decision: allow
  - id: git-config-safe
    command: "git config user.email"
    expected:
      decision: allow
  - id: git-diff-staged
    command: "git diff --staged"
    expected:
      decision: allow
  - id: git-log-oneline
    command: "git log --oneline -10"
    expected:
      decision: allow
  - id: git-show-commit
    command: "git show abc1234"
    expected:
      decision: allow
  - id: git-branch-list
    command: "git branch -a"
    expected:
      decision: allow
  - id: git-force-push-main-long
    command: "git push --force origin main"
    expected:
      decision: deny
      rule_id: git-force-push-main
  - id: git-clean-fx
    command: "git clean -fx"
    expected:
      decision: ask
      rule_id: git-clean-force
  - id: git-clean-fxd
    command: "git clean -fxd"
    expected:
      decision: ask
      rule_id: git-clean-force
  - id: git-reset-hard-head
    command: "git reset --hard"
    expected:
      decision: ask
      rule_id: git-reset-hard
  - id: git-stash-push
    command: "git stash push"
    expected:
      decision: allow
  - id: git-merge
    command: "git merge feature-branch"
    expected:
      decision: allow
  - id: git-rebase
    command: "git rebase main"
    expected:
      decision: allow
  - id: git-cherry-pick
    command: "git cherry-pick abc1234"
    expected:
      decision: allow
  - id: git-fetch
    command: "git fetch origin"
    expected:
      decision: allow
  - id: git-pull
    command: "git pull origin main"
    expected:
      decision: allow
  - id: git-switch-safe
    command: "git switch feature-branch"
    expected:
      decision: allow
  - id: git-restore-safe
    command: "git restore file.txt"
    expected:
      decision: allow
  - id: git-worktree-safe
    command: "git worktree add ../feature feature-branch"
    expected:
      decision: allow
  - id: git-clone-safe
    command: "git clone https://github.com/user/repo.git"
    expected:
      decision: allow
  - id: git-init-safe
    command: "git init"
    expected:
      decision: allow
  - id: git-blame-safe
    command: "git blame src/main.rs"
    expected:
      decision: allow
  - id: git-bisect-safe
    command: "git bisect start"
    expected:
      decision: allow
  - id: git-describe-safe
    command: "git describe --tags"
    expected:
      decision: allow
  - id: git-shortlog-safe
    command: "git shortlog -sn"
    expected:
      decision: allow
  - id: git-reflog-safe
    command: "git reflog"
    expected:
      decision: allow
  - id: git-ls-files-safe
    command: "git ls-files"
    expected:
      decision: allow
  - id: git-ls-tree-safe
    command: "git ls-tree HEAD"
    expected:
      decision: allow
  - id: git-cat-file-safe
    command: "git cat-file -p HEAD"
    expected:
      decision: allow
